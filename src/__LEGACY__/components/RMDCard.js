import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer, Legend, } from "recharts";
export default function RMDCard({ comparison }) {
    const { baseline, roth } = comparison;
    // Build chart data: one row per year with both scenarios
    const chartData = baseline.years.map((b, idx) => {
        const r = roth.years[idx] ?? roth.years[roth.years.length - 1];
        return {
            year: b.year,
            age: b.age,
            baselineRMD: Math.round(b.rmd),
            rothRMD: Math.round(r.rmd),
            baselineCumTax: Math.round(b.cumulativeTax),
            rothCumTax: Math.round(r.cumulativeTax),
        };
    });
    const lifetimeTaxSaved = baseline.totalTax - roth.totalTax;
    const lifetimeRMDSaved = baseline.totalRMD - roth.totalRMD;
    return (_jsxs("div", { className: "card rmd-card", children: [_jsx("h2", { children: "Required Minimum Distributions (RMD)" }), _jsxs("div", { className: "rmd-summary-row", children: [_jsx(SummaryBox, { title: "Without Roth Conversions", firstRMD: baseline.firstRMD, totalRMD: baseline.totalRMD, totalTax: baseline.totalTax, maxBracket: baseline.maxBracketRate }), _jsx(SummaryBox, { title: "With Roth Strategy", firstRMD: roth.firstRMD, totalRMD: roth.totalRMD, totalTax: roth.totalTax, maxBracket: roth.maxBracketRate, highlight: true }), _jsxs("div", { className: "rmd-savings", children: [_jsx("h3", { children: "Roth Opportunity" }), _jsxs("p", { children: ["Lifetime RMDs reduced by", " ", _jsxs("strong", { children: ["$", Math.round(lifetimeRMDSaved).toLocaleString()] }), "."] }), _jsxs("p", { children: ["Lifetime taxes reduced by", " ", _jsxs("strong", { children: ["$", Math.round(lifetimeTaxSaved).toLocaleString()] }), "."] })] })] }), _jsxs("div", { className: "rmd-chart-row", children: [_jsxs("div", { className: "chart-card", children: [_jsx("h4", { children: "RMD Amounts Over Time" }), _jsx(ResponsiveContainer, { width: "100%", height: 250, children: _jsxs(LineChart, { data: chartData, children: [_jsx(XAxis, { dataKey: "age", tickFormatter: (age) => `Age ${age}` }), _jsx(YAxis, {}), _jsx(Tooltip, { formatter: (v) => `$${v.toLocaleString()}` }), _jsx(Legend, {}), _jsx(Line, { type: "monotone", dataKey: "baselineRMD", name: "No Roth", stroke: "#a855f7", dot: false }), _jsx(Line, { type: "monotone", dataKey: "rothRMD", name: "With Roth", stroke: "#22c55e", dot: false })] }) })] }), _jsxs("div", { className: "chart-card", children: [_jsx("h4", { children: "Lifetime Tax Impact" }), _jsx(ResponsiveContainer, { width: "100%", height: 250, children: _jsxs(LineChart, { data: chartData, children: [_jsx(XAxis, { dataKey: "age", tickFormatter: (age) => `Age ${age}` }), _jsx(YAxis, {}), _jsx(Tooltip, { formatter: (v) => `$${v.toLocaleString()}` }), _jsx(Legend, {}), _jsx(Line, { type: "monotone", dataKey: "baselineCumTax", name: "No Roth", stroke: "#f97316", dot: false }), _jsx(Line, { type: "monotone", dataKey: "rothCumTax", name: "With Roth", stroke: "#0ea5e9", dot: false })] }) })] })] }), _jsxs("div", { className: "rmd-insights-row", children: [_jsxs("div", { className: "insight-card", children: [_jsx("h4", { children: "Bracket Pressure" }), _jsxs("p", { children: ["Without Roth, your peak bracket usage reaches", " ", _jsxs("strong", { children: [baseline.maxBracketUsagePct.toFixed(1), "%"] }), " of the", " ", _jsxs("strong", { children: [(baseline.maxBracketRate * 100).toFixed(0), "%"] }), " ", "bracket."] }), _jsxs("p", { children: ["With Roth, your peak usage is only", " ", _jsxs("strong", { children: [roth.maxBracketUsagePct.toFixed(1), "%"] }), " of the", " ", _jsxs("strong", { children: [(roth.maxBracketRate * 100).toFixed(0), "%"] }), " bracket."] })] }), _jsxs("div", { className: "insight-card", children: [_jsx("h4", { children: "Medicare / IRMAA" }), _jsx("p", { children: "This v3 preview assumes Standard IRMAA. In a later version, we\u2019ll plug in the real IRMAA tiers to show how Roth conversions help avoid higher Medicare premiums." })] })] })] }));
}
function SummaryBox({ title, firstRMD, totalRMD, totalTax, maxBracket, highlight, }) {
    return (_jsxs("div", { className: `summary-box ${highlight ? "highlight" : ""}`, children: [_jsx("h3", { children: title }), _jsxs("p", { children: ["First RMD: ", _jsxs("strong", { children: ["$", Math.round(firstRMD).toLocaleString()] })] }), _jsxs("p", { children: ["Lifetime RMDs: ", _jsxs("strong", { children: ["$", Math.round(totalRMD).toLocaleString()] })] }), _jsxs("p", { children: ["Lifetime Taxes (approx):", " ", _jsxs("strong", { children: ["$", Math.round(totalTax).toLocaleString()] })] }), _jsxs("p", { children: ["Highest bracket reached: ", (maxBracket * 100).toFixed(0), "%"] })] }));
}
